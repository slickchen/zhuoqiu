<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>简洁对战记录系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        body {
            background-color: #1a1a2e;
            color: #e6e6e6;
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #0f4c75;
        }

        h1 {
            color: #4cc9f0;
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .container {
            display: grid;
            gap: 25px;
        }

        .section {
            background-color: #162447;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .section-title {
            color: #4cc9f0;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #0f4c75;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .section-title .toggle-btn {
            background-color: #1f4068;
            border: 2px solid #0f4c75;
            color: #e6e6e6;
            padding: 5px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .section-title .toggle-btn:hover {
            background-color: #0f4c75;
        }

        .mode-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .mode-btn {
            flex: 1;
            padding: 12px;
            background-color: #1f4068;
            border: 2px solid #0f4c75;
            color: #e6e6e6;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s ease;
        }

        .mode-btn:hover {
            background-color: #0f4c75;
        }

        .mode-btn.active {
            background-color: #4cc9f0;
            color: #1a1a2e;
            border-color: #4cc9f0;
        }

        .team-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .team {
            background-color: #1f4068;
            padding: 15px;
            border-radius: 8px;
        }

        .team-title {
            color: #fca311;
            margin-bottom: 10px;
            font-weight: 600;
        }

        select {
            width: 100%;
            padding: 10px;
            background-color: #0f3460;
            color: #e6e6e6;
            border: 1px solid #4cc9f0;
            border-radius: 6px;
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .defeat-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .defeat-option {
            flex: 1;
            padding: 12px;
            background-color: #1f4068;
            border: 2px solid #0f4c75;
            color: #e6e6e6;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
        }

        .defeat-option:hover {
            background-color: #0f4c75;
        }

        .defeat-option.selected {
            background-color: #e63946;
            border-color: #e63946;
        }

        .input-note {
            width: 100%;
            padding: 10px;
            background-color: #0f3460;
            color: #e6e6e6;
            border: 1px solid #4cc9f0;
            border-radius: 6px;
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .char-count {
            text-align: right;
            font-size: 0.8rem;
            color: #a9a9a9;
            margin-top: 5px;
        }

        .btn {
            display: block;
            width: 100%;
            padding: 14px;
            background-color: #4cc9f0;
            color: #1a1a2e;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .btn:hover {
            background-color: #2ab7e9;
        }

        .btn-view-history {
            background-color: #9b59b6;
        }

        .btn-view-history:hover {
            background-color: #8e44ad;
        }

        .btn-clear-history {
            background-color: #e63946;
        }

        .btn-clear-history:hover {
            background-color: #d32f2f;
        }

        .player-list {
            list-style: none;
            margin-top: 15px;
        }

        .player-item {
            background-color: #1f4068;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .player-name {
            font-weight: 600;
        }

        .player-type {
            font-size: 0.8rem;
            padding: 3px 8px;
            border-radius: 10px;
        }

        .player-type.fixed {
            background-color: #4cc9f0;
            color: #1a1a2e;
        }

        .player-type.custom {
            background-color: #fca311;
            color: #1a1a2e;
        }

        .custom-player-input {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .custom-player-input input {
            flex: 1;
            padding: 10px;
            background-color: #0f3460;
            color: #e6e6e6;
            border: 1px solid #4cc9f0;
            border-radius: 6px;
        }

        .custom-player-input button {
            padding: 10px 20px;
            background-color: #4cc9f0;
            color: #1a1a2e;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: #2ecc71;
            color: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background-color: #e63946;
        }

        .notification.info {
            background-color: #4cc9f0;
        }

        .history-item {
            background-color: #1f4068;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            border-left: 5px solid #4cc9f0;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: #fca311;
            font-weight: 600;
        }

        .history-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 0.9rem;
        }

        .history-note {
            margin-top: 10px;
            padding: 8px;
            background-color: #0f3460;
            border-radius: 4px;
            font-style: italic;
        }

        .empty-history {
            text-align: center;
            padding: 30px;
            color: #a9a9a9;
            font-style: italic;
        }

        .history-count {
            text-align: center;
            margin-bottom: 15px;
            color: #a9a9a9;
            font-size: 0.9rem;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal {
            background-color: #162447;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .modal-title {
            color: #4cc9f0;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.5rem;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .modal-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .modal-btn.confirm {
            background-color: #e63946;
            color: white;
        }

        .modal-btn.confirm:hover {
            background-color: #d32f2f;
        }

        .modal-btn.cancel {
            background-color: #4cc9f0;
            color: #1a1a2e;
        }

        .modal-btn.cancel:hover {
            background-color: #2ab7e9;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #0f4c75;
            color: #a9a9a9;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .mode-selector, .defeat-selector {
                flex-direction: column;
            }
            
            .custom-player-input {
                flex-direction: column;
            }
            
            .history-details {
                grid-template-columns: 1fr;
            }
            
            .modal {
                width: 95%;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1><i class="fas fa-gamepad"></i> 简洁对战记录系统</h1>
        <p>支持1v1 / 2v2对战模式，可查看历史记录</p>
    </header>

    <div class="container">
        <div class="section">
            <h2 class="section-title"><i class="fas fa-cogs"></i> 对战设置</h2>
            
            <div class="mode-selector">
                <div class="mode-btn active" id="mode1v1">1V1 对战</div>
                <div class="mode-btn" id="mode2v2">2V2 对战</div>
            </div>
            
            <div class="team-container">
                <div class="team" id="teamA">
                    <div class="team-title">A 队</div>
                    <select id="playerA1">
                        <option value="">选择玩家1</option>
                    </select>
                    <select id="playerA2" style="display: none;">
                        <option value="">选择玩家2</option>
                    </select>
                </div>
                
                <div class="team" id="teamB">
                    <div class="team-title">B 队</div>
                    <select id="playerB1">
                        <option value="">选择玩家1</option>
                    </select>
                    <select id="playerB2" style="display: none;">
                        <option value="">选择玩家2</option>
                    </select>
                </div>
            </div>
            
            <div class="defeat-selector">
                <div class="defeat-option" id="defeatA">A队战败</div>
                <div class="defeat-option" id="defeatB">B队战败</div>
            </div>
            
            <div>
                <input type="text" class="input-note" id="battleNote" placeholder="备注（仅支持大写字母 A-Z）" maxlength="10">
                <div class="char-count">仅支持大写英文字母（A-Z），最多10个字符</div>
            </div>
            
            <button class="btn" id="recordBattle">
                <i class="fas fa-save"></i> 记录对战结果
            </button>
            
            <button class="btn btn-view-history" id="viewHistory">
                <i class="fas fa-history"></i> 查看对战记录
            </button>
        </div>
        
        <div class="section">
            <h2 class="section-title">
                <span><i class="fas fa-users"></i> 玩家列表</span>
                <button class="toggle-btn" id="togglePlayers">
                    <i class="fas fa-eye-slash"></i> 隐藏列表
                </button>
            </h2>
            
            <div id="playersContent">
                <h3>固定玩家（7位）：</h3>
                <ul class="player-list" id="fixedPlayers"></ul>
                
                <h3>自定义玩家（可添加3位）：</h3>
                <ul class="player-list" id="customPlayers"></ul>
                
                <div class="custom-player-input">
                    <input type="text" id="customPlayerInput" placeholder="输入自定义玩家名称">
                    <button id="saveCustomPlayer">添加</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 历史记录模态框 -->
    <div class="modal-overlay" id="historyModal">
        <div class="modal">
            <h3 class="modal-title"><i class="fas fa-history"></i> 对战历史记录</h3>
            
            <div class="history-count" id="historyCount">当前共有 0 条对战记录</div>
            
            <div id="historyList">
                <div class="empty-history">
                    <i class="fas fa-history fa-2x" style="margin-bottom: 15px;"></i>
                    <p>暂无对战记录</p>
                    <p>请开始记录对战</p>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="closeHistory">关闭</button>
                <button class="modal-btn confirm" id="clearHistory">清除所有记录</button>
            </div>
        </div>
    </div>

    <!-- 确认清除模态框 -->
    <div class="modal-overlay" id="clearConfirmModal">
        <div class="modal">
            <h3 class="modal-title"><i class="fas fa-exclamation-triangle"></i> 确认清除</h3>
            <div class="modal-content" id="clearConfirmMessage">
                确定要清除所有对战记录吗？此操作不可撤销！
            </div>
            <div class="modal-buttons">
                <button class="modal-btn confirm" id="confirmClear">确定清除</button>
                <button class="modal-btn cancel" id="cancelClear">取消</button>
            </div>
        </div>
    </div>

    <!-- 通知 -->
    <div class="notification" id="notification">
        <i class="fas fa-info-circle"></i>
        <span id="notificationMessage">这是一条通知</span>
    </div>
    
    <footer>
        <p>简洁对战记录系统 &copy; 2023 | 支持1v1 / 2v2对战模式</p>
    </footer>

    <script>
        // 初始固定玩家列表 - 指定的7位玩家
        const fixedPlayers = [
            "第一陈", 
            "斯提芬饭", 
            "低质量黎", 
            "复愁满伍", 
            "鬼仔关", 
            "十二生肖", 
            "老王子米高"
        ];
        
        // 初始自定义玩家列表
        let customPlayers = ["自定义1", "自定义2", "自定义3"];
        
        // 对战历史记录
        let battleHistory = [];
        
        // DOM元素
        const mode1v1Btn = document.getElementById('mode1v1');
        const mode2v2Btn = document.getElementById('mode2v2');
        const playerA2Select = document.getElementById('playerA2');
        const playerB2Select = document.getElementById('playerB2');
        const defeatAOption = document.getElementById('defeatA');
        const defeatBOption = document.getElementById('defeatB');
        const battleNoteInput = document.getElementById('battleNote');
        const recordBattleBtn = document.getElementById('recordBattle');
        const viewHistoryBtn = document.getElementById('viewHistory');
        const fixedPlayersList = document.getElementById('fixedPlayers');
        const customPlayersList = document.getElementById('customPlayers');
        const customPlayerInput = document.getElementById('customPlayerInput');
        const saveCustomPlayerBtn = document.getElementById('saveCustomPlayer');
        const togglePlayersBtn = document.getElementById('togglePlayers');
        const playersContent = document.getElementById('playersContent');
        const historyModal = document.getElementById('historyModal');
        const historyList = document.getElementById('historyList');
        const historyCount = document.getElementById('historyCount');
        const closeHistoryBtn = document.getElementById('closeHistory');
        const clearHistoryBtn = document.getElementById('clearHistory');
        const clearConfirmModal = document.getElementById('clearConfirmModal');
        const confirmClearBtn = document.getElementById('confirmClear');
        const cancelClearBtn = document.getElementById('cancelClear');
        const notification = document.getElementById('notification');
        const notificationMessage = document.getElementById('notificationMessage');
        
        // 玩家列表是否显示
        let playersVisible = true;
        
        // 初始化页面
        function initPage() {
            // 从本地存储加载数据
            loadFromLocalStorage();
            
            // 初始化玩家选择下拉菜单
            initPlayerSelects();
            
            // 初始化玩家列表显示
            renderPlayerLists();
            
            // 设置默认对战模式
            setMode('1v1');
            
            // 设置默认战败方
            selectDefeat('A');
            
            // 设置事件监听器
            setupEventListeners();
            
            // 渲染历史记录
            renderHistory();
            
            // 更新历史记录计数
            updateHistoryCount();
        }
        
        // 从本地存储加载数据
        function loadFromLocalStorage() {
            const savedCustomPlayers = localStorage.getItem('customPlayers');
            const savedBattleHistory = localStorage.getItem('battleHistory');
            
            if (savedCustomPlayers) {
                customPlayers = JSON.parse(savedCustomPlayers);
            }
            
            if (savedBattleHistory) {
                battleHistory = JSON.parse(savedBattleHistory);
            }
        }
        
        // 保存到本地存储
        function saveToLocalStorage() {
            localStorage.setItem('customPlayers', JSON.stringify(customPlayers));
            localStorage.setItem('battleHistory', JSON.stringify(battleHistory));
        }
        
        // 初始化玩家选择下拉菜单
        function initPlayerSelects() {
            const allPlayers = [...fixedPlayers, ...customPlayers];
            const playerSelects = [
                document.getElementById('playerA1'),
                document.getElementById('playerA2'),
                document.getElementById('playerB1'),
                document.getElementById('playerB2')
            ];
            
            // 清空所有选项（除了第一个占位选项）
            playerSelects.forEach(select => {
                while (select.options.length > 1) {
                    select.remove(1);
                }
            });
            
            // 添加玩家选项
            allPlayers.forEach(player => {
                playerSelects.forEach(select => {
                    const option = document.createElement('option');
                    option.value = player;
                    option.textContent = player;
                    select.appendChild(option);
                });
            });
            
            // 设置默认选择
            if (allPlayers.length >= 2) {
                document.getElementById('playerA1').value = allPlayers[0];
                document.getElementById('playerB1').value = allPlayers[1];
            }
        }
        
        // 渲染玩家列表
        function renderPlayerLists() {
            // 清空列表
            fixedPlayersList.innerHTML = '';
            customPlayersList.innerHTML = '';
            
            // 渲染固定玩家
            fixedPlayers.forEach((player, index) => {
                const li = document.createElement('li');
                li.className = 'player-item';
                li.innerHTML = `
                    <div>
                        <span style="color: #a9a9a9; margin-right: 8px;">${index + 1}.</span>
                        <span class="player-name">${player}</span>
                    </div>
                    <span class="player-type fixed">固定</span>
                `;
                fixedPlayersList.appendChild(li);
            });
            
            // 渲染自定义玩家
            customPlayers.forEach((player, index) => {
                const li = document.createElement('li');
                li.className = 'player-item';
                li.innerHTML = `
                    <div>
                        <span style="color: #a9a9a9; margin-right: 8px;">${index + 1}.</span>
                        <span class="player-name">${player}</span>
                    </div>
                    <span class="player-type custom">自定义</span>
                `;
                customPlayersList.appendChild(li);
            });
        }
        
        // 设置事件监听器
        function setupEventListeners() {
            // 模式切换
            mode1v1Btn.addEventListener('click', () => setMode('1v1'));
            mode2v2Btn.addEventListener('click', () => setMode('2v2'));
            
            // 战败方选择
            defeatAOption.addEventListener('click', () => selectDefeat('A'));
            defeatBOption.addEventListener('click', () => selectDefeat('B'));
            
            // 记录对战结果
            recordBattleBtn.addEventListener('click', recordBattle);
            
            // 查看历史记录
            viewHistoryBtn.addEventListener('click', showHistoryModal);
            
            // 保存自定义玩家
            saveCustomPlayerBtn.addEventListener('click', saveCustomPlayer);
            customPlayerInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    saveCustomPlayer();
                }
            });
            
            // 隐藏/显示玩家列表
            togglePlayersBtn.addEventListener('click', togglePlayersList);
            
            // 关闭历史记录模态框
            closeHistoryBtn.addEventListener('click', hideHistoryModal);
            
            // 清除历史记录
            clearHistoryBtn.addEventListener('click', showClearConfirm);
            confirmClearBtn.addEventListener('click', clearAllHistory);
            cancelClearBtn.addEventListener('click', hideClearConfirm);
            
            // 备注输入限制
            battleNoteInput.addEventListener('input', validateNoteInput);
            
            // 点击模态框外部关闭
            historyModal.addEventListener('click', (e) => {
                if (e.target === historyModal) {
                    hideHistoryModal();
                }
            });
            
            clearConfirmModal.addEventListener('click', (e) => {
                if (e.target === clearConfirmModal) {
                    hideClearConfirm();
                }
            });
        }
        
        // 设置对战模式
        function setMode(mode) {
            if (mode === '1v1') {
                mode1v1Btn.classList.add('active');
                mode2v2Btn.classList.remove('active');
                playerA2Select.style.display = 'none';
                playerB2Select.style.display = 'none';
            } else {
                mode1v1Btn.classList.remove('active');
                mode2v2Btn.classList.add('active');
                playerA2Select.style.display = 'block';
                playerB2Select.style.display = 'block';
            }
        }
        
        // 选择战败方
        function selectDefeat(team) {
            defeatAOption.classList.remove('selected');
            defeatBOption.classList.remove('selected');
            
            if (team === 'A') {
                defeatAOption.classList.add('selected');
            } else {
                defeatBOption.classList.add('selected');
            }
        }
        
        // 验证备注输入 - 只允许大写字母A-Z，不允许数字0-9
        function validateNoteInput() {
            let value = battleNoteInput.value;
            // 只允许大写字母A-Z，不允许数字
            value = value.replace(/[^A-Z]/g, '');
            battleNoteInput.value = value;
        }
        
        // 记录对战结果
        function recordBattle() {
            // 获取对战模式
            const mode = mode1v1Btn.classList.contains('active') ? '1v1' : '2v2';
            
            // 获取队伍成员
            const playerA1 = document.getElementById('playerA1').value;
            const playerA2 = mode === '2v2' ? document.getElementById('playerA2').value : '';
            const playerB1 = document.getElementById('playerB1').value;
            const playerB2 = mode === '2v2' ? document.getElementById('playerB2').value : '';
            
            // 验证必须选择的玩家
            if (!playerA1 || !playerB1 || (mode === '2v2' && (!playerA2 || !playerB2))) {
                showNotification('请选择所有玩家！', 'error');
                return;
            }
            
            // 检查是否有重复的玩家
            const players = [playerA1, playerA2, playerB1, playerB2].filter(p => p);
            const uniquePlayers = [...new Set(players)];
            if (players.length !== uniquePlayers.length) {
                showNotification('不能选择相同的玩家！', 'error');
                return;
            }
            
            // 获取战败方
            const defeatTeam = defeatAOption.classList.contains('selected') ? 'A' : 
                              defeatBOption.classList.contains('selected') ? 'B' : null;
            
            if (!defeatTeam) {
                showNotification('请选择战败方！', 'error');
                return;
            }
            
            // 获取备注并验证格式 - 只允许大写字母，不允许数字
            const note = battleNoteInput.value;
            // 验证备注只包含大写字母
            const notePattern = /^[A-Z]{0,10}$/;
            if (note && !notePattern.test(note)) {
                showNotification('备注只能包含大写字母（A-Z），最多10个字符！', 'error');
                return;
            }
            
            // 创建对战记录
            const battleRecord = {
                id: Date.now(),
                mode: mode,
                teamA: mode === '1v1' ? [playerA1] : [playerA1, playerA2],
                teamB: mode === '1v1' ? [playerB1] : [playerB1, playerB2],
                defeatedTeam: defeatTeam,
                note: note,
                timestamp: new Date().toLocaleString('zh-CN')
            };
            
            // 添加到历史记录
            battleHistory.unshift(battleRecord);
            
            // 保存到本地存储
            saveToLocalStorage();
            
            // 渲染历史记录
            renderHistory();
            
            // 更新历史记录计数
            updateHistoryCount();
            
            // 重置表单
            battleNoteInput.value = '';
            
            showNotification('对战记录已保存！', 'success');
        }
        
        // 保存自定义玩家
        function saveCustomPlayer() {
            const playerName = customPlayerInput.value.trim();
            
            if (!playerName) {
                showNotification('请输入玩家名称！', 'error');
                return;
            }
            
            if (playerName.length > 10) {
                showNotification('玩家名称不能超过10个字符！', 'error');
                return;
            }
            
            // 检查是否已存在
            const allPlayers = [...fixedPlayers, ...customPlayers];
            if (allPlayers.includes(playerName)) {
                showNotification('该玩家已存在！', 'error');
                return;
            }
            
            // 查找空的自定义玩家位置或替换现有的自定义玩家
            const emptyIndex = customPlayers.findIndex(player => player.startsWith('自定义'));
            
            if (emptyIndex !== -1) {
                customPlayers[emptyIndex] = playerName;
            } else {
                // 如果所有自定义玩家位置都已满，替换第一个
                customPlayers[0] = playerName;
            }
            
            // 保存到本地存储
            saveToLocalStorage();
            
            // 更新玩家列表和选择下拉菜单
            renderPlayerLists();
            initPlayerSelects();
            
            // 清空输入框
            customPlayerInput.value = '';
            
            showNotification('自定义玩家已保存！', 'success');
        }
        
        // 切换玩家列表显示/隐藏
        function togglePlayersList() {
            playersVisible = !playersVisible;
            
            if (playersVisible) {
                playersContent.style.display = 'block';
                togglePlayersBtn.innerHTML = '<i class="fas fa-eye-slash"></i> 隐藏列表';
            } else {
                playersContent.style.display = 'none';
                togglePlayersBtn.innerHTML = '<i class="fas fa-eye"></i> 显示列表';
            }
        }
        
        // 显示历史记录模态框
        function showHistoryModal() {
            renderHistory();
            updateHistoryCount();
            historyModal.style.display = 'flex';
        }
        
        // 隐藏历史记录模态框
        function hideHistoryModal() {
            historyModal.style.display = 'none';
        }
        
        // 渲染历史记录
        function renderHistory() {
            if (battleHistory.length === 0) {
                historyList.innerHTML = `
                    <div class="empty-history">
                        <i class="fas fa-history fa-2x" style="margin-bottom: 15px;"></i>
                        <p>暂无对战记录</p>
                        <p>请开始记录对战</p>
                    </div>
                `;
                return;
            }
            
            let historyHTML = '';
            battleHistory.forEach((record, index) => {
                const teamAText = record.teamA.join(' & ');
                const teamBText = record.teamB.join(' & ');
                
                historyHTML += `
                    <div class="history-item">
                        <div class="history-header">
                            <span>${record.mode === '1v1' ? '1V1 对战' : '2V2 对战'} (#${index + 1})</span>
                            <span>${record.timestamp}</span>
                        </div>
                        <div class="history-details">
                            <div><strong>A队：</strong> ${teamAText}</div>
                            <div><strong>B队：</strong> ${teamBText}</div>
                            <div><strong>战败方：</strong> <span style="color: #e63946;">${record.defeatedTeam}队</span></div>
                        </div>
                        ${record.note ? `<div class="history-note"><strong>备注：</strong> ${record.note}</div>` : ''}
                    </div>
                `;
            });
            
            historyList.innerHTML = historyHTML;
        }
        
        // 更新历史记录计数
        function updateHistoryCount() {
            const count = battleHistory.length;
            historyCount.textContent = `当前共有 ${count} 条对战记录`;
        }
        
        // 显示清除确认模态框
        function showClearConfirm() {
            if (battleHistory.length === 0) {
                showNotification('当前没有对战记录可清除！', 'info');
                hideHistoryModal();
                return;
            }
            
            hideHistoryModal();
            clearConfirmModal.style.display = 'flex';
        }
        
        // 隐藏清除确认模态框
        function hideClearConfirm() {
            clearConfirmModal.style.display = 'none';
        }
        
        // 清除所有历史记录
        function clearAllHistory() {
            battleHistory = [];
            saveToLocalStorage();
            renderHistory();
            updateHistoryCount();
            hideClearConfirm();
            showNotification('所有对战记录已清除！', 'success');
        }
        
        // 显示通知
        function showNotification(message, type = 'info') {
            notificationMessage.textContent = message;
            notification.className = 'notification ' + type;
            
            // 显示通知
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            // 3秒后隐藏通知
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html>
